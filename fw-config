set firewall ipv4 name DMZ-to-LAN default-action 'drop'
set firewall ipv4 name DMZ-to-LAN default-log
set firewall ipv4 name DMZ-to-LAN rule 1 action 'accept'
set firewall ipv4 name DMZ-to-LAN rule 1 state 'established'
set firewall ipv4 name DMZ-to-LAN rule 10 action 'accept'
set firewall ipv4 name DMZ-to-LAN rule 10 description 'Wazuh agent communication with wazuh server'
set firewall ipv4 name DMZ-to-LAN rule 10 destination address '172.16.200.10'
set firewall ipv4 name DMZ-to-LAN rule 10 destination port '1514,1515'
set firewall ipv4 name DMZ-to-LAN rule 10 protocol 'tcp'
set firewall ipv4 name DMZ-to-WAN default-action 'drop'
set firewall ipv4 name DMZ-to-WAN default-log
set firewall ipv4 name DMZ-to-WAN rule 1 action 'accept'
set firewall ipv4 name DMZ-to-WAN rule 1 state 'established'
set firewall ipv4 name LAN-to-DMZ default-action 'drop'
set firewall ipv4 name LAN-to-DMZ default-log
set firewall ipv4 name LAN-to-DMZ rule 1 action 'accept'
set firewall ipv4 name LAN-to-DMZ rule 1 state 'established'
set firewall ipv4 name LAN-to-DMZ rule 10 action 'accept'
set firewall ipv4 name LAN-to-DMZ rule 10 description 'connection to web01'
set firewall ipv4 name LAN-to-DMZ rule 10 destination address '172.16.50.3'
set firewall ipv4 name LAN-to-DMZ rule 10 destination port '80'
set firewall ipv4 name LAN-to-DMZ rule 10 protocol 'tcp'
set firewall ipv4 name LAN-to-DMZ rule 20 action 'accept'
set firewall ipv4 name LAN-to-DMZ rule 20 description 'ssh from mgmt01 to dmz'
set firewall ipv4 name LAN-to-DMZ rule 20 destination port '22'
set firewall ipv4 name LAN-to-DMZ rule 20 protocol 'tcp'
set firewall ipv4 name LAN-to-DMZ rule 20 source address '172.16.150.10'
set firewall ipv4 name LAN-to-WAN default-action 'drop'
set firewall ipv4 name LAN-to-WAN default-log
set firewall ipv4 name LAN-to-WAN rule 1 action 'accept'
set firewall ipv4 name WAN-to-DMZ default-action 'drop'
set firewall ipv4 name WAN-to-DMZ default-log
set firewall ipv4 name WAN-to-DMZ rule 10 action 'accept'
set firewall ipv4 name WAN-to-DMZ rule 10 destination address '172.16.50.3'
set firewall ipv4 name WAN-to-DMZ rule 10 destination port '80'
set firewall ipv4 name WAN-to-DMZ rule 10 protocol 'tcp'
set firewall ipv4 name WAN-to-LAN default-action 'drop'
set firewall ipv4 name WAN-to-LAN default-log
set firewall ipv4 name WAN-to-LAN rule 1 action 'accept'
set firewall ipv4 name WAN-to-LAN rule 1 state 'established'
set firewall zone DMZ from LAN firewall name 'LAN-to-DMZ'
set firewall zone DMZ from WAN firewall name 'WAN-to-DMZ'
set firewall zone DMZ member interface 'eth2'
set firewall zone LAN from DMZ firewall name 'DMZ-to-LAN'
set firewall zone LAN from WAN firewall name 'WAN-to-LAN'
set firewall zone LAN member interface 'eth1'
set firewall zone WAN from DMZ firewall name 'DMZ-to-WAN'
set firewall zone WAN from LAN firewall name 'LAN-to-WAN'
set firewall zone WAN member interface 'eth0'
set interfaces ethernet eth0 address '10.0.17.131/24'
set interfaces ethernet eth0 description 'WAN'
set interfaces ethernet eth0 hw-id 'bc:24:11:43:9c:7b'
set interfaces ethernet eth0 offload gro
set interfaces ethernet eth0 offload gso
set interfaces ethernet eth0 offload sg
set interfaces ethernet eth0 offload tso
set interfaces ethernet eth1 address '172.16.150.2/24'
set interfaces ethernet eth1 description 'LAN'
set interfaces ethernet eth1 hw-id 'bc:24:11:74:b5:79'
set interfaces ethernet eth2 address '172.16.50.2/29'
set interfaces ethernet eth2 description 'DMZ'
set interfaces ethernet eth2 hw-id 'bc:24:11:a8:3b:90'
set interfaces loopback lo
set nat source rule 10 description 'NAT FROM DMZ to WAN'
set nat source rule 10 outbound-interface name 'eth0'
set nat source rule 10 source address '172.16.50.0/29'
set nat source rule 10 translation address 'masquerade'
set nat source rule 20 description 'NAT FROM LAN to WAN'
set nat source rule 20 outbound-interface name 'eth0'
set nat source rule 20 source address '172.16.150.0/24'
set nat source rule 20 translation address 'masquerade'
set nat source rule 30 description 'NAT FROM MGMT to WAN'
set nat source rule 30 outbound-interface name 'eth0'
set nat source rule 30 source address '172.16.200.0/28'
set nat source rule 30 translation address 'masquerade'
set protocols rip interface eth1
set protocols rip network '172.16.50.0/29'
set protocols static route 0.0.0.0/0 next-hop 10.0.17.2
set service dns forwarding allow-from '172.16.50.0/29'
set service dns forwarding allow-from '172.16.150.0/24'
set service dns forwarding listen-address '172.16.50.2'
set service dns forwarding listen-address '172.16.150.2'
set service dns forwarding system
set service ntp allow-client address '127.0.0.0/8'
set service ntp allow-client address '169.254.0.0/16'
set service ntp allow-client address '10.0.0.0/8'
set service ntp allow-client address '172.16.0.0/12'
set service ntp allow-client address '192.168.0.0/16'
set service ntp allow-client address '::1/128'
set service ntp allow-client address 'fe80::/10'
set service ntp allow-client address 'fc00::/7'
set service ntp server time1.vyos.net
set service ntp server time2.vyos.net
set service ntp server time3.vyos.net
set service ssh access-control allow
set system config-management commit-revisions '100'
set system console device ttyS0 speed '115200'
set system host-name 'fw01-aidan.stewart'
set system login operator-group default command-policy allow '*'
set system login user deployer authentication encrypted-password '$6$rounds=656000$kZGG17SHOn6PYNb7$DE05q2Cul4BAnMqb0KVi6sGEDAkWrl2SOKWYOf3DMSF.bCFTEVEZyWen/6UYMSY7qo6jX51PaA0bWeKotPPRc1'
set system login user deployer full-name 'deployer'
set system login user newuser full-name 'deployer'
set system login user newuswer disable
set system login user vyos authentication encrypted-password '$6$rounds=656000$IzF6lxRwMhM08fvQ$lpwkxdOxXd5w7vEHboE035eVwwRqAtvd2HY/DV5DBIsRmYL8qhj6TRTPqP38XM6UHG3cAcnTZH9nf4UuZIflB1'
set system name-server '10.0.17.2'
set system option reboot-on-upgrade-failure '5'
set system syslog local facility all level 'info'
set system syslog local facility local7 level 'debug'
